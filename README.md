Select b.Timestamp Date_Month,'TSK_PELLET' AS PLANT,ROUND((a.ACTUAL_QUANTITY))NET_PROD,
ROUND(b.NET_PRODUCTIVITY,1)NET_PRODUCTIVITY,
Round(c.FE,1)FE,Round(c.CAO/Nullif(c.SIO2,0),2)B2,
Round(c.AL2O3,2)AL2O3,Round(c.P,3)Phos,
Round(c.K2O,3)K2O,ROUND(d.AVG_CCS)CCS_CRMT,Round(c.PCT_TUM_6P3MM,1)TUMBLER_PLS_6P3_MM,
Round(c.PLS_TUM_MIN_0P5MM,2)TUMBLER_MIN_0P5_MM,ROUND(AVG(e.RDI),2)RDI,ROUND(AVG(f.RI),1)RI,
Round(AVG(g.SWELLING_INDEX),1)SWELLING_INDEX_CRMT,
ROUND((nvl(b.NOA_ORE,0)+nvl(b.JODA_ORE,0)+nvl(b.CRUSHED_FINES,0)+nvl(b.NINL_ORE,0)+nvl(b.KHONDBOND_ORE,0)))TOT_IRON_ORE,
ROUND((nvl(b.ANTHRACITE_FUEL,0)+nvl(b.NUT_COKE_FUEL,0)+nvl(b.COKE_BREEZE_FUEL,0)),1)Solid_Fuel,
ROUND(b.BENTONITE,2)BENTONITE,
ROUND(b.NOA_ORE/Decode((nvl(b.NOA_ORE,0)+nvl(b.JODA_ORE,0)+nvl(b.CRUSHED_FINES,0)+nvl(b.NINL_ORE,0)+nvl(b.KHONDBOND_ORE,0)),0,
NULL,(nvl(b.NOA_ORE,0)+nvl(b.JODA_ORE,0)+nvl(b.CRUSHED_FINES,0)+nvl(b.NINL_ORE,0)+nvl(b.KHONDBOND_ORE,0)))*100,1) NOA_PERC,
ROUND(b.JODA_ORE/Decode((nvl(b.NOA_ORE,0)+nvl(b.JODA_ORE,0)+nvl(b.CRUSHED_FINES,0)+nvl(b.NINL_ORE,0)+nvl(b.KHONDBOND_ORE,0)),0,
NULL,(nvl(b.NOA_ORE,0)+nvl(b.JODA_ORE,0)+nvl(b.CRUSHED_FINES,0)+nvl(b.NINL_ORE,0)+nvl(b.KHONDBOND_ORE,0)))*100,1) JODA_PERC,
ROUND(AVG((nvl(h.ENG_CONS_DRYER_1,0)+nvl(i.ENG_CONS_DRYER_2,0))/Decode((nvl2(h.ENG_CONS_DRYER_1,1,0)+nvl2(i.ENG_CONS_DRYER_2,1,0)),0,NULL,(nvl2(h.ENG_CONS_DRYER_1,1,0)+nvl2(i.ENG_CONS_DRYER_2,1,0)))))AVG_ENG_COM
FROM KPO.T_KPO_COST_DATA a,KPO.T_KPO_PELLET_PROD_MONTHLY b,KPO.t_kpo_Pellet_quality_monthly c ,
KPO.T_KPO_PELLET_CCS_MONTHLY d,KPO.T_KPO_PELLET_RDI_DAILY e, KPO.T_KPO_PELLET_RI_DAILY f,
KPO.T_KPO_PELLET_SWELLING_INDEX_DAILY g,KPO.T_KPO_PELLET_DRYING_GRIND_PROCESS_DAILY h ,KPO.T_KPO_PELLET_DRYGRIND_STREAM2_DAILY i
Where c.SOURCE(+)='PRODUCT' AND c.PLANT(+)='KPO-Pellet Plant'
AND a.AREA(+)='100028600' AND a.COST_TYPE(+)='MC' AND a.COST_ELEMENT(+)='111105481'
AND  b.Timestamp=c.DATE_MONTH(+) AND b.Timestamp=d.DATE_MONTH(+)
AND b.Timestamp=Trunc(e.DATE_Time(+),'MON') AND b.Timestamp=Trunc(f.DATE_Time(+),'MON')AND 
b.Timestamp=Trunc(g.DATE_Time(+),'MON')AND b.Timestamp=Trunc(a.DATE_Time(+),'MON') AND 
Trunc(b.Timestamp,'MON')=Trunc(h.Timestamp(+),'MON') AND Trunc(h.Timestamp,'MON')<Trunc(SYSDATE,'MON') AND
Trunc(b.Timestamp,'MON')=Trunc(i.Timestamp(+),'MON')AND
Trunc(g.Date_Time,'MON')<Trunc(SYSDATE,'MOn')  AND 
Trunc(f.Date_Time,'MON')<Trunc(SYSDATE,'MOn')  AND
Trunc(e.Date_Time,'MON')<Trunc(SYSDATE,'MOn')  AND
b.Timestamp>=sysdate-365
Group by b.Timestamp,b.NET_PRODUCTIVITY,c.FE,c.CAO,c.SIO2,c.AL2O3,c.P,
c.K2O,d.AVG_CCS,c.PCT_TUM_6P3MM,c.PLS_TUM_MIN_0P5MM,a.ACTUAL_QUANTITY,b.NOA_ORE,b.JODA_ORE,b.CRUSHED_FINES,b.NINL_ORE,b.KHONDBOND_ORE,b.BENTONITE,
b.ANTHRACITE_FUEL,b.NUT_COKE_FUEL,b.COKE_BREEZE_FUEL
