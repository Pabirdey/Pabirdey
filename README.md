SELECT 
    DATE_TIME,
    PLANT,
    AVG(DECODE(SOURCE, 'FEED IRON ORE FOR DRI', DECODE(FET_TOT, 0, NULL, FET_TOT))) AS FET_TOT,
    AVG(DECODE(SOURCE, 'FEED IRON ORE FOR DRI', DECODE(TOT_MOIST, 0, NULL, TOT_MOIST))) AS TOT_MOIST_ORE,
    AVG(DECODE(SOURCE, 'FEED IRON ORE FOR DRI', DECODE(LOI, 0, NULL, LOI))) AS LOI,
    AVG(DECODE(SOURCE, 'FEED COAL FOR DRI', DECODE(ASH, 0, NULL, ASH))) AS ASH,
    AVG(DECODE(SOURCE, 'FEED COAL FOR DRI', DECODE(VOLATILE, 0, NULL, VOLATILE))) AS VOLATILE,
    AVG(DECODE(SOURCE, 'FEED COAL FOR DRI', DECODE(FC, 0, NULL, FC))) AS FC,
    AVG(DECODE(SOURCE, 'FEED COAL FOR DRI', DECODE(TOT_MOIST, 0, NULL, TOT_MOIST))) AS TOT_MOIST_COAL
FROM 
    TSLPL.T_TSG_DRI_QUALITY_SHIFT
WHERE 
    DATE_TIME >= SYSDATE - 2
    AND SHIFT IN ('A','B','C')
GROUP BY 
    DATE_TIME, PLANT
ORDER BY 
    DATE_TIME;
