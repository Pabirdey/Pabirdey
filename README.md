SELECT 
    TIMESTAMP,
    ( NVL(ENG_CONS_DRYER_1, 0) + NVL(ENG_CONS_DRYER_2, 0) ) /
    DECODE(
        ( NVL2(ENG_CONS_DRYER_1, 1, 0) + NVL2(ENG_CONS_DRYER_2, 1, 0) ),
        0, NULL,
        ( NVL2(ENG_CONS_DRYER_1, 1, 0) + NVL2(ENG_CONS_DRYER_2, 1, 0) )
    ) AS AVG_ENG_CONS_DRYER
FROM T_PELLET_INDUR_MONTHLY03
WHERE TIMESTAMP >= TO_DATE('01-APR-2025', 'DD-MON-YYYY')
ORDER BY TIMESTAMP;
