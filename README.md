Select DATE_TIME,PLANT,
AVG(DECODE(SOURCE,'FEED IRON ORE FOR DRI',Decode(FET_TOT,0,NULL,FET_TOT)))FET_TOT,
AVG(DECODE(SOURCE,'FEED IRON ORE FOR DRI',Decode(TOT_MOIST,0,null,TOT_MOIST)))TOT_MOIST,
AVG(DECODE(SOURCE,'FEED IRON ORE FOR DRI',Decode(LOI,0,null,LOI)))LOI,
AVG(DECODE(SOURCE,'FEED COAL FOR DRI',Decode(ASH,0,null,ASH)))ASH,
AVG(DECODE(SOURCE,'FEED COAL FOR DRI',Decode(VOLATILE,0,null,VOLATILE)))VOLATILE,
AVG(DECODE(SOURCE,'FEED COAL FOR DRI',Decode(FC,0,null,FC)))FC,
AVG(DECODE(SOURCE,'FEED COAL FOR DRI',Decode(TOT_MOIST,0,null,TOT_MOIST)))TOT_MOIST
From  TSLPL.T_TSG_DRI_QUALITY_SHIFT Where DATE_TIME>=sysdate-2 AND SHIFT in ('A','B','C')
GROUP BY DATE_TIME,PLANT Order by DATE_TIME
