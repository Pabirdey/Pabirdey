Select SAMPLE_DATE,
AVG(Decode(PRODUCT,'SO',Decode(DESTINATION,'TSBSL',QUANTITY)))QTY_TSM_SO,
AVG(Decode(PRODUCT,'SO',Decode(DESTINATION,'TSBSL',AL2O3)))AL2O3_TSM_SO,
AVG(Decode(PRODUCT,'SO',Decode(DESTINATION,'TSBSL',K2O)))K2O_TSM_SO,
AVG(Decode(PRODUCT,'SO',Decode(DESTINATION,'TSBSL',Fe)))FE_TSM_SO,
AVG(Decode(PRODUCT,'SO',Decode(DESTINATION,'TSBSL',Phos)))PHOS_TSM_SO,
AVG(Decode(PRODUCT,'SO',Decode(DESTINATION,'KPO',Decode(DESTINATION,'kpo',QUANTITY))))QTY_KPO_SO,
AVG(Decode(PRODUCT,'SO',Decode(DESTINATION,'KPO',Decode(DESTINATION,'kpo',AL2O3))))AL2O3_KPO_SO,
AVG(Decode(PRODUCT,'SO',Decode(DESTINATION,'KPO',Decode(DESTINATION,'kpo',K2O))))K2O_KPO_SO,
AVG(Decode(PRODUCT,'SO',Decode(DESTINATION,'KPO',Decode(DESTINATION,'kpo',Fe))))FE_KPO_SO,
AVG(Decode(PRODUCT,'SO',Decode(DESTINATION,'KPO',Decode(DESTINATION,'kpo',Phos))))PHOS_KPO_SO,
AVG(Decode(PRODUCT,'BF',Decode(DESTINATION,'TSBSL',QUANTITY)))QTY_TSM_BF,
AVG(Decode(PRODUCT,'BF',Decode(DESTINATION,'TSBSL',AL2O3)))AL2O3_TSM_BF,
AVG(Decode(PRODUCT,'BF',Decode(DESTINATION,'TSBSL',K2O)))K2O_TSM_BF,
AVG(Decode(PRODUCT,'BF',Decode(DESTINATION,'TSBSL',Fe)))FE_TSM_BF,
AVG(Decode(PRODUCT,'BF',Decode(DESTINATION,'TSBSL',Phos)))PHOS_TSM_BF
From T_KHONDBOND_ORE 
Where SAMPLE_DATE>=sysdate-10 
Group by SAMPLE_DATE
Order by SAMPLE_DATE;

